{
  "version": 3,
  "sources": ["../src/engine/renderer/Renderer.ts", "../src/engine/math/Vector2.ts", "../src/engine/commons/EventEmitter.ts", "../src/engine/input/InputManager.ts", "../src/engine/scene/SceneManager.ts", "../src/engine/physics/PhysicsWorld.ts", "../src/engine/math/MathUtils.ts", "../src/engine/camera/Camera2D.ts", "../src/engine/GameCore.ts", "../src/engine/scene/Scene.ts", "../src/engine/commons/ObjectPool.ts", "../src/engine/spatial/QuadTree.ts", "../src/engine/physics/PhysicsBody.ts", "../src/game/GalaxyParticle.ts", "../src/game/GalaxyScene.ts", "../src/main.ts"],
  "sourcesContent": ["/**\r\n * Renderer - Canvas 2D abstraction layer with HiDPI support\r\n */\r\nimport { Camera2D } from '../camera/Camera2D.js';\r\nimport { Vector2 } from '../math/Vector2.js';\r\n\r\nexport class Renderer {\r\n    canvas: HTMLCanvasElement;\r\n    ctx: CanvasRenderingContext2D;\r\n    private pixelRatio: number;\r\n\r\n    constructor(canvas: HTMLCanvasElement) {\r\n        this.canvas = canvas;\r\n        const ctx = canvas.getContext('2d');\r\n        if (!ctx) throw new Error('Failed to get 2D context');\r\n        this.ctx = ctx;\r\n        this.pixelRatio = window.devicePixelRatio || 1;\r\n        this.resize(window.innerWidth, window.innerHeight);\r\n\r\n        window.addEventListener('resize', () => {\r\n            this.resize(window.innerWidth, window.innerHeight);\r\n        });\r\n    }\r\n\r\n    resize(width: number, height: number): void {\r\n        const pr = this.pixelRatio;\r\n        this.canvas.width = width * pr;\r\n        this.canvas.height = height * pr;\r\n        this.canvas.style.width = `${width}px`;\r\n        this.canvas.style.height = `${height}px`;\r\n        this.ctx.scale(pr, pr);\r\n    }\r\n\r\n    get width(): number { return this.canvas.width / this.pixelRatio; }\r\n    get height(): number { return this.canvas.height / this.pixelRatio; }\r\n\r\n    clear(color: string = '#000000'): void {\r\n        this.ctx.setTransform(this.pixelRatio, 0, 0, this.pixelRatio, 0, 0);\r\n        this.ctx.fillStyle = color;\r\n        this.ctx.fillRect(0, 0, this.width, this.height);\r\n    }\r\n\r\n    applyCamera(camera: Camera2D): void {\r\n        const pr = this.pixelRatio;\r\n        this.ctx.setTransform(\r\n            camera.zoom * pr, 0,\r\n            0, camera.zoom * pr,\r\n            (this.width * 0.5 - camera.position.x * camera.zoom) * pr,\r\n            (this.height * 0.5 - camera.position.y * camera.zoom) * pr\r\n        );\r\n    }\r\n\r\n    resetTransform(): void {\r\n        this.ctx.setTransform(this.pixelRatio, 0, 0, this.pixelRatio, 0, 0);\r\n    }\r\n\r\n    // \u2500\u2500\u2500 Drawing primitives \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\r\n\r\n    fillCircle(x: number, y: number, radius: number, color: string): void {\r\n        this.ctx.beginPath();\r\n        this.ctx.arc(x, y, radius, 0, Math.PI * 2);\r\n        this.ctx.fillStyle = color;\r\n        this.ctx.fill();\r\n    }\r\n\r\n    strokeCircle(x: number, y: number, radius: number, color: string, lineWidth: number = 1): void {\r\n        this.ctx.beginPath();\r\n        this.ctx.arc(x, y, radius, 0, Math.PI * 2);\r\n        this.ctx.strokeStyle = color;\r\n        this.ctx.lineWidth = lineWidth;\r\n        this.ctx.stroke();\r\n    }\r\n\r\n    fillRect(x: number, y: number, w: number, h: number, color: string): void {\r\n        this.ctx.fillStyle = color;\r\n        this.ctx.fillRect(x, y, w, h);\r\n    }\r\n\r\n    line(x1: number, y1: number, x2: number, y2: number, color: string, lineWidth: number = 1): void {\r\n        this.ctx.beginPath();\r\n        this.ctx.moveTo(x1, y1);\r\n        this.ctx.lineTo(x2, y2);\r\n        this.ctx.strokeStyle = color;\r\n        this.ctx.lineWidth = lineWidth;\r\n        this.ctx.stroke();\r\n    }\r\n\r\n    text(text: string, x: number, y: number, color: string = '#fff', size: number = 14, align: CanvasTextAlign = 'left'): void {\r\n        this.ctx.fillStyle = color;\r\n        this.ctx.font = `${size}px Inter, system-ui, sans-serif`;\r\n        this.ctx.textAlign = align;\r\n        this.ctx.fillText(text, x, y);\r\n    }\r\n\r\n    createRadialGradient(x: number, y: number, r0: number, r1: number): CanvasGradient {\r\n        return this.ctx.createRadialGradient(x, y, r0, x, y, r1);\r\n    }\r\n\r\n    setGlobalAlpha(alpha: number): void { this.ctx.globalAlpha = alpha; }\r\n    setCompositeOperation(op: GlobalCompositeOperation): void { this.ctx.globalCompositeOperation = op; }\r\n    setShadow(blur: number, color: string): void { this.ctx.shadowBlur = blur; this.ctx.shadowColor = color; }\r\n    clearShadow(): void { this.ctx.shadowBlur = 0; this.ctx.shadowColor = 'transparent'; }\r\n\r\n    save(): void { this.ctx.save(); }\r\n    restore(): void { this.ctx.restore(); }\r\n}\r\n", "/**\r\n * Vector2 - 2D vector math class\r\n */\r\nexport class Vector2 {\r\n    constructor(public x: number = 0, public y: number = 0) { }\r\n\r\n    static zero(): Vector2 { return new Vector2(0, 0); }\r\n    static one(): Vector2 { return new Vector2(1, 1); }\r\n    static fromAngle(angle: number, length: number = 1): Vector2 {\r\n        return new Vector2(Math.cos(angle) * length, Math.sin(angle) * length);\r\n    }\r\n\r\n    set(x: number, y: number): this { this.x = x; this.y = y; return this; }\r\n    clone(): Vector2 { return new Vector2(this.x, this.y); }\r\n\r\n    add(v: Vector2): Vector2 { return new Vector2(this.x + v.x, this.y + v.y); }\r\n    addSelf(v: Vector2): this { this.x += v.x; this.y += v.y; return this; }\r\n    sub(v: Vector2): Vector2 { return new Vector2(this.x - v.x, this.y - v.y); }\r\n    subSelf(v: Vector2): this { this.x -= v.x; this.y -= v.y; return this; }\r\n    scale(s: number): Vector2 { return new Vector2(this.x * s, this.y * s); }\r\n    scaleSelf(s: number): this { this.x *= s; this.y *= s; return this; }\r\n    negate(): Vector2 { return new Vector2(-this.x, -this.y); }\r\n    negateSelf(): this { this.x = -this.x; this.y = -this.y; return this; }\r\n\r\n    dot(v: Vector2): number { return this.x * v.x + this.y * v.y; }\r\n    cross(v: Vector2): number { return this.x * v.y - this.y * v.x; }\r\n\r\n    magnitudeSq(): number { return this.x * this.x + this.y * this.y; }\r\n    magnitude(): number { return Math.sqrt(this.magnitudeSq()); }\r\n\r\n    normalize(): Vector2 {\r\n        const m = this.magnitude();\r\n        return m > 0 ? this.scale(1 / m) : Vector2.zero();\r\n    }\r\n    normalizeSelf(): this {\r\n        const m = this.magnitude();\r\n        if (m > 0) { this.x /= m; this.y /= m; }\r\n        return this;\r\n    }\r\n\r\n    distance(v: Vector2): number { return this.sub(v).magnitude(); }\r\n    distanceSq(v: Vector2): number { return this.sub(v).magnitudeSq(); }\r\n\r\n    angle(): number { return Math.atan2(this.y, this.x); }\r\n    angleTo(v: Vector2): number { return Math.atan2(v.y - this.y, v.x - this.x); }\r\n\r\n    lerp(v: Vector2, t: number): Vector2 {\r\n        return new Vector2(this.x + (v.x - this.x) * t, this.y + (v.y - this.y) * t);\r\n    }\r\n\r\n    perpendicular(): Vector2 { return new Vector2(-this.y, this.x); }\r\n\r\n    rotate(angle: number): Vector2 {\r\n        const c = Math.cos(angle), s = Math.sin(angle);\r\n        return new Vector2(this.x * c - this.y * s, this.x * s + this.y * c);\r\n    }\r\n\r\n    equals(v: Vector2, epsilon: number = 0.0001): boolean {\r\n        return Math.abs(this.x - v.x) < epsilon && Math.abs(this.y - v.y) < epsilon;\r\n    }\r\n\r\n    toString(): string { return `Vector2(${this.x.toFixed(3)}, ${this.y.toFixed(3)})`; }\r\n}\r\n", "/**\r\n * EventEmitter - Lightweight typed event bus\r\n */\r\ntype Listener<T = unknown> = (data: T) => void;\r\n\r\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\r\nexport class EventEmitter<EventMap extends Record<string, any> = Record<string, any>> {\r\n    private listeners: Map<string, Set<Listener<unknown>>> = new Map();\r\n    private onceListeners: Map<string, Set<Listener<unknown>>> = new Map();\r\n\r\n    on<K extends keyof EventMap & string>(event: K, listener: Listener<EventMap[K]>): this {\r\n        if (!this.listeners.has(event)) this.listeners.set(event, new Set());\r\n        this.listeners.get(event)!.add(listener as Listener<unknown>);\r\n        return this;\r\n    }\r\n\r\n    off<K extends keyof EventMap & string>(event: K, listener: Listener<EventMap[K]>): this {\r\n        this.listeners.get(event)?.delete(listener as Listener<unknown>);\r\n        this.onceListeners.get(event)?.delete(listener as Listener<unknown>);\r\n        return this;\r\n    }\r\n\r\n    once<K extends keyof EventMap & string>(event: K, listener: Listener<EventMap[K]>): this {\r\n        if (!this.onceListeners.has(event)) this.onceListeners.set(event, new Set());\r\n        this.onceListeners.get(event)!.add(listener as Listener<unknown>);\r\n        return this;\r\n    }\r\n\r\n    emit<K extends keyof EventMap & string>(event: K, data?: EventMap[K]): this {\r\n        this.listeners.get(event)?.forEach(l => l(data as unknown));\r\n        const onceSet = this.onceListeners.get(event);\r\n        if (onceSet) {\r\n            onceSet.forEach(l => l(data as unknown));\r\n            onceSet.clear();\r\n        }\r\n        return this;\r\n    }\r\n\r\n    removeAllListeners(event?: string): this {\r\n        if (event) { this.listeners.delete(event); this.onceListeners.delete(event); }\r\n        else { this.listeners.clear(); this.onceListeners.clear(); }\r\n        return this;\r\n    }\r\n}\r\n", "/**\r\n * InputManager - Keyboard, mouse, and wheel input tracking\r\n */\r\nimport { Vector2 } from '../math/Vector2.js';\r\nimport { EventEmitter } from '../commons/EventEmitter.js';\r\n\r\ninterface InputEvents {\r\n    keydown: { key: string; code: string };\r\n    keyup: { key: string; code: string };\r\n    mousedown: { button: number; x: number; y: number };\r\n    mouseup: { button: number; x: number; y: number };\r\n    mousemove: { x: number; y: number; dx: number; dy: number };\r\n    wheel: { delta: number; x: number; y: number };\r\n}\r\n\r\nexport class InputManager extends EventEmitter<InputEvents> {\r\n    private keysDown: Set<string> = new Set();\r\n    private keysPressed: Set<string> = new Set(); // pressed this frame\r\n    private keysReleased: Set<string> = new Set(); // released this frame\r\n    private mouseButtons: Set<number> = new Set();\r\n    private mousePos: Vector2 = new Vector2();\r\n    private mouseDelta: Vector2 = new Vector2();\r\n    private wheelDelta: number = 0;\r\n    private canvas: HTMLElement;\r\n\r\n    constructor(canvas: HTMLElement) {\r\n        super();\r\n        this.canvas = canvas;\r\n        this.bindEvents();\r\n    }\r\n\r\n    private bindEvents(): void {\r\n        window.addEventListener('keydown', (e) => {\r\n            if (!this.keysDown.has(e.code)) {\r\n                this.keysPressed.add(e.code);\r\n            }\r\n            this.keysDown.add(e.code);\r\n            this.emit('keydown', { key: e.key, code: e.code });\r\n        });\r\n\r\n        window.addEventListener('keyup', (e) => {\r\n            this.keysDown.delete(e.code);\r\n            this.keysReleased.add(e.code);\r\n            this.emit('keyup', { key: e.key, code: e.code });\r\n        });\r\n\r\n        this.canvas.addEventListener('mousedown', (e) => {\r\n            this.mouseButtons.add(e.button);\r\n            this.emit('mousedown', { button: e.button, x: e.clientX, y: e.clientY });\r\n            e.preventDefault();\r\n        });\r\n\r\n        window.addEventListener('mouseup', (e) => {\r\n            this.mouseButtons.delete(e.button);\r\n            this.emit('mouseup', { button: e.button, x: e.clientX, y: e.clientY });\r\n        });\r\n\r\n        window.addEventListener('mousemove', (e) => {\r\n            this.mouseDelta.set(e.movementX, e.movementY);\r\n            this.mousePos.set(e.clientX, e.clientY);\r\n            this.emit('mousemove', { x: e.clientX, y: e.clientY, dx: e.movementX, dy: e.movementY });\r\n        });\r\n\r\n        this.canvas.addEventListener('wheel', (e) => {\r\n            this.wheelDelta += e.deltaY;\r\n            this.emit('wheel', { delta: e.deltaY, x: e.clientX, y: e.clientY });\r\n            e.preventDefault();\r\n        }, { passive: false });\r\n    }\r\n\r\n    /** Call at end of each frame to reset single-frame state */\r\n    endFrame(): void {\r\n        this.keysPressed.clear();\r\n        this.keysReleased.clear();\r\n        this.mouseDelta.set(0, 0);\r\n        this.wheelDelta = 0;\r\n    }\r\n\r\n    isKeyDown(code: string): boolean { return this.keysDown.has(code); }\r\n    isKeyPressed(code: string): boolean { return this.keysPressed.has(code); }\r\n    isKeyReleased(code: string): boolean { return this.keysReleased.has(code); }\r\n    isMouseDown(button: number = 0): boolean { return this.mouseButtons.has(button); }\r\n\r\n    getMousePosition(): Vector2 { return this.mousePos.clone(); }\r\n    getMouseDelta(): Vector2 { return this.mouseDelta.clone(); }\r\n    getWheelDelta(): number { return this.wheelDelta; }\r\n\r\n    destroy(): void { this.removeAllListeners(); }\r\n}\r\n", "/**\r\n * SceneManager - Manages a stack of scenes\r\n */\r\nimport { Scene, SceneContext } from './Scene.js';\r\nimport { Renderer } from '../renderer/Renderer.js';\r\n\r\nexport class SceneManager {\r\n    private stack: Scene[] = [];\r\n    private ctx!: SceneContext;\r\n\r\n    initialize(ctx: SceneContext): void {\r\n        this.ctx = ctx;\r\n    }\r\n\r\n    push(scene: Scene): void {\r\n        scene.onEnter(this.ctx);\r\n        this.stack.push(scene);\r\n    }\r\n\r\n    pop(): Scene | undefined {\r\n        const scene = this.stack.pop();\r\n        scene?.onExit();\r\n        if (this.stack.length > 0) {\r\n            this.stack[this.stack.length - 1].onEnter(this.ctx);\r\n        }\r\n        return scene;\r\n    }\r\n\r\n    replace(scene: Scene): void {\r\n        if (this.stack.length > 0) {\r\n            this.stack[this.stack.length - 1].onExit();\r\n            this.stack.pop();\r\n        }\r\n        scene.onEnter(this.ctx);\r\n        this.stack.push(scene);\r\n    }\r\n\r\n    get current(): Scene | undefined {\r\n        return this.stack[this.stack.length - 1];\r\n    }\r\n\r\n    update(dt: number): void {\r\n        this.current?.update(dt);\r\n    }\r\n\r\n    render(renderer: Renderer): void {\r\n        // Render all scenes (bottom to top, so top is on top)\r\n        for (const scene of this.stack) {\r\n            scene.render(renderer);\r\n        }\r\n    }\r\n\r\n    onResize(width: number, height: number): void {\r\n        for (const scene of this.stack) {\r\n            scene.onResize(width, height);\r\n        }\r\n    }\r\n}\r\n", "/**\r\n * PhysicsWorld - Container for physics bodies with gravity attractors\r\n */\r\nimport { Vector2 } from '../math/Vector2.js';\r\nimport { PhysicsBody } from './PhysicsBody.js';\r\n\r\nexport interface GravityAttractor {\r\n    position: Vector2;\r\n    mass: number;\r\n    softening: number; // Softening parameter to avoid singularity\r\n}\r\n\r\nexport class PhysicsWorld {\r\n    bodies: PhysicsBody[] = [];\r\n    attractors: GravityAttractor[] = [];\r\n    gravitationalConstant: number = 6.674e-3; // Scaled G for simulation\r\n    maxForce: number = 5000;\r\n\r\n    addBody(body: PhysicsBody): void {\r\n        this.bodies.push(body);\r\n    }\r\n\r\n    removeBody(body: PhysicsBody): void {\r\n        const idx = this.bodies.indexOf(body);\r\n        if (idx !== -1) this.bodies.splice(idx, 1);\r\n    }\r\n\r\n    addAttractor(position: Vector2, mass: number, softening: number = 50): GravityAttractor {\r\n        const attractor: GravityAttractor = { position: position.clone(), mass, softening };\r\n        this.attractors.push(attractor);\r\n        return attractor;\r\n    }\r\n\r\n    removeAttractor(attractor: GravityAttractor): void {\r\n        const idx = this.attractors.indexOf(attractor);\r\n        if (idx !== -1) this.attractors.splice(idx, 1);\r\n    }\r\n\r\n    update(dt: number): void {\r\n        const G = this.gravitationalConstant;\r\n        const maxF = this.maxForce;\r\n\r\n        for (let i = 0; i < this.bodies.length; i++) {\r\n            const body = this.bodies[i];\r\n            if (body.isStatic) continue;\r\n\r\n            // Apply gravitational attraction from all attractors\r\n            for (let j = 0; j < this.attractors.length; j++) {\r\n                const attractor = this.attractors[j];\r\n                const dx = attractor.position.x - body.position.x;\r\n                const dy = attractor.position.y - body.position.y;\r\n                const softSq = attractor.softening * attractor.softening;\r\n                const distSq = dx * dx + dy * dy + softSq;\r\n                const dist = Math.sqrt(distSq);\r\n\r\n                // F = G * M * m / r^2\r\n                let forceMag = (G * attractor.mass * body.mass) / distSq;\r\n                if (forceMag > maxF) forceMag = maxF;\r\n\r\n                body.acceleration.x += (dx / dist) * forceMag * body.inverseMass;\r\n                body.acceleration.y += (dy / dist) * forceMag * body.inverseMass;\r\n            }\r\n\r\n            body.integrate(dt);\r\n        }\r\n    }\r\n\r\n    clear(): void {\r\n        this.bodies.length = 0;\r\n        this.attractors.length = 0;\r\n    }\r\n}\r\n", "/**\r\n * MathUtils - Common math utility functions\r\n */\r\nexport const MathUtils = {\r\n    PI2: Math.PI * 2,\r\n\r\n    clamp(value: number, min: number, max: number): number {\r\n        return Math.max(min, Math.min(max, value));\r\n    },\r\n\r\n    lerp(a: number, b: number, t: number): number {\r\n        return a + (b - a) * t;\r\n    },\r\n\r\n    smoothstep(edge0: number, edge1: number, x: number): number {\r\n        const t = MathUtils.clamp((x - edge0) / (edge1 - edge0), 0, 1);\r\n        return t * t * (3 - 2 * t);\r\n    },\r\n\r\n    smootherstep(edge0: number, edge1: number, x: number): number {\r\n        const t = MathUtils.clamp((x - edge0) / (edge1 - edge0), 0, 1);\r\n        return t * t * t * (t * (t * 6 - 15) + 10);\r\n    },\r\n\r\n    map(value: number, inMin: number, inMax: number, outMin: number, outMax: number): number {\r\n        return outMin + (outMax - outMin) * ((value - inMin) / (inMax - inMin));\r\n    },\r\n\r\n    randomRange(min: number, max: number): number {\r\n        return min + Math.random() * (max - min);\r\n    },\r\n\r\n    randomInt(min: number, max: number): number {\r\n        return Math.floor(MathUtils.randomRange(min, max + 1));\r\n    },\r\n\r\n    randomSign(): number { return Math.random() < 0.5 ? -1 : 1; },\r\n\r\n    degToRad(degrees: number): number { return degrees * (Math.PI / 180); },\r\n    radToDeg(radians: number): number { return radians * (180 / Math.PI); },\r\n\r\n    normalizeAngle(angle: number): number {\r\n        while (angle > Math.PI) angle -= MathUtils.PI2;\r\n        while (angle < -Math.PI) angle += MathUtils.PI2;\r\n        return angle;\r\n    },\r\n\r\n    isPowerOf2(n: number): boolean { return (n & (n - 1)) === 0; },\r\n\r\n    sign(n: number): number { return n < 0 ? -1 : n > 0 ? 1 : 0; },\r\n\r\n    approximately(a: number, b: number, epsilon: number = 0.0001): boolean {\r\n        return Math.abs(a - b) < epsilon;\r\n    },\r\n\r\n    gaussianRandom(mean: number = 0, stddev: number = 1): number {\r\n        // Box-Muller transform\r\n        const u = 1 - Math.random();\r\n        const v = Math.random();\r\n        const z = Math.sqrt(-2 * Math.log(u)) * Math.cos(MathUtils.PI2 * v);\r\n        return mean + z * stddev;\r\n    },\r\n} as const;\r\n", "/**\r\n * Camera2D - World-to-screen and screen-to-world transforms with pan and zoom\r\n */\r\nimport { Vector2 } from '../math/Vector2.js';\r\nimport { MathUtils } from '../math/MathUtils.js';\r\n\r\nexport class Camera2D {\r\n    position: Vector2; // World position the camera looks at\r\n    zoom: number;\r\n    minZoom: number;\r\n    maxZoom: number;\r\n    private _screenWidth: number;\r\n    private _screenHeight: number;\r\n\r\n    constructor(screenWidth: number, screenHeight: number) {\r\n        this.position = Vector2.zero();\r\n        this.zoom = 1;\r\n        this.minZoom = 0.01;\r\n        this.maxZoom = 50;\r\n        this._screenWidth = screenWidth;\r\n        this._screenHeight = screenHeight;\r\n    }\r\n\r\n    get screenWidth(): number { return this._screenWidth; }\r\n    get screenHeight(): number { return this._screenHeight; }\r\n\r\n    resize(w: number, h: number): void {\r\n        this._screenWidth = w;\r\n        this._screenHeight = h;\r\n    }\r\n\r\n    /** Converts a world-space point to screen-space */\r\n    worldToScreen(worldPos: Vector2): Vector2 {\r\n        return new Vector2(\r\n            (worldPos.x - this.position.x) * this.zoom + this._screenWidth * 0.5,\r\n            (worldPos.y - this.position.y) * this.zoom + this._screenHeight * 0.5\r\n        );\r\n    }\r\n\r\n    /** Converts a screen-space point to world-space */\r\n    screenToWorld(screenPos: Vector2): Vector2 {\r\n        return new Vector2(\r\n            (screenPos.x - this._screenWidth * 0.5) / this.zoom + this.position.x,\r\n            (screenPos.y - this._screenHeight * 0.5) / this.zoom + this.position.y\r\n        );\r\n    }\r\n\r\n    /** Pan camera by a screen-space delta */\r\n    pan(screenDelta: Vector2): void {\r\n        this.position.x -= screenDelta.x / this.zoom;\r\n        this.position.y -= screenDelta.y / this.zoom;\r\n    }\r\n\r\n    /** Zoom centered on a screen-space point */\r\n    zoomAt(screenPoint: Vector2, factor: number): void {\r\n        const worldBefore = this.screenToWorld(screenPoint);\r\n        this.zoom = MathUtils.clamp(this.zoom * factor, this.minZoom, this.maxZoom);\r\n        const worldAfter = this.screenToWorld(screenPoint);\r\n        // Compensate so the point under the cursor stays fixed\r\n        this.position.x += worldBefore.x - worldAfter.x;\r\n        this.position.y += worldBefore.y - worldAfter.y;\r\n    }\r\n\r\n    /** Apply camera transform to a Canvas 2D context */\r\n    applyToContext(ctx: CanvasRenderingContext2D): void {\r\n        ctx.setTransform(\r\n            this.zoom, 0,\r\n            0, this.zoom,\r\n            this._screenWidth * 0.5 - this.position.x * this.zoom,\r\n            this._screenHeight * 0.5 - this.position.y * this.zoom\r\n        );\r\n    }\r\n\r\n    /** Get the visible world bounds */\r\n    getWorldBounds(): { left: number; right: number; top: number; bottom: number } {\r\n        const hw = (this._screenWidth * 0.5) / this.zoom;\r\n        const hh = (this._screenHeight * 0.5) / this.zoom;\r\n        return {\r\n            left: this.position.x - hw,\r\n            right: this.position.x + hw,\r\n            top: this.position.y - hh,\r\n            bottom: this.position.y + hh,\r\n        };\r\n    }\r\n\r\n    isPointVisible(worldPos: Vector2, margin: number = 0): boolean {\r\n        const bounds = this.getWorldBounds();\r\n        return worldPos.x >= bounds.left - margin &&\r\n            worldPos.x <= bounds.right + margin &&\r\n            worldPos.y >= bounds.top - margin &&\r\n            worldPos.y <= bounds.bottom + margin;\r\n    }\r\n}\r\n", "/**\r\n * GameCore - Central engine class with fixed-timestep game loop\r\n */\r\nimport { Renderer } from './renderer/Renderer.js';\r\nimport { InputManager } from './input/InputManager.js';\r\nimport { SceneManager } from './scene/SceneManager.js';\r\nimport { PhysicsWorld } from './physics/PhysicsWorld.js';\r\nimport { Camera2D } from './camera/Camera2D.js';\r\nimport { Scene } from './scene/Scene.js';\r\nimport { EventEmitter } from './commons/EventEmitter.js';\r\n\r\nexport interface GameConfig {\r\n    canvas: HTMLCanvasElement;\r\n    fixedDt?: number;      // Fixed physics timestep in seconds (default: 1/60)\r\n    maxDeltaTime?: number; // Maximum allowed dt to prevent spiral of death (default: 0.1)\r\n}\r\n\r\ninterface GameCoreEvents {\r\n    start: undefined;\r\n    stop: undefined;\r\n    update: { dt: number; fixedDt: number };\r\n    render: { renderer: Renderer };\r\n    resize: { width: number; height: number };\r\n}\r\n\r\nexport class GameCore extends EventEmitter<GameCoreEvents> {\r\n    readonly renderer: Renderer;\r\n    readonly input: InputManager;\r\n    readonly scenes: SceneManager;\r\n    readonly physics: PhysicsWorld;\r\n    readonly camera: Camera2D;\r\n\r\n    private running: boolean = false;\r\n    private rafId: number = 0;\r\n    private lastTime: number = 0;\r\n    private accumulator: number = 0;\r\n    private readonly fixedDt: number;\r\n    private readonly maxDeltaTime: number;\r\n\r\n    // Stats\r\n    fps: number = 0;\r\n    frameTime: number = 0;\r\n    private fpsAccumulator: number = 0;\r\n    private fpsFrames: number = 0;\r\n\r\n    constructor(config: GameConfig) {\r\n        super();\r\n        this.fixedDt = config.fixedDt ?? 1 / 60;\r\n        this.maxDeltaTime = config.maxDeltaTime ?? 0.1;\r\n\r\n        this.renderer = new Renderer(config.canvas);\r\n        this.input = new InputManager(config.canvas);\r\n        this.camera = new Camera2D(this.renderer.width, this.renderer.height);\r\n        this.physics = new PhysicsWorld();\r\n        this.scenes = new SceneManager();\r\n        this.scenes.initialize({\r\n            renderer: this.renderer,\r\n            input: this.input,\r\n            camera: this.camera,\r\n            physics: this.physics,\r\n        });\r\n\r\n        window.addEventListener('resize', () => {\r\n            const w = window.innerWidth;\r\n            const h = window.innerHeight;\r\n            this.camera.resize(w, h);\r\n            this.scenes.onResize(w, h);\r\n            this.emit('resize', { width: w, height: h });\r\n        });\r\n    }\r\n\r\n    start(initialScene?: Scene): void {\r\n        if (this.running) return;\r\n        this.running = true;\r\n\r\n        if (initialScene) {\r\n            this.scenes.push(initialScene);\r\n        }\r\n\r\n        this.lastTime = performance.now();\r\n        this.emit('start', undefined);\r\n        this.loop(performance.now());\r\n    }\r\n\r\n    stop(): void {\r\n        this.running = false;\r\n        cancelAnimationFrame(this.rafId);\r\n        this.emit('stop', undefined);\r\n    }\r\n\r\n    private loop = (timestamp: number): void => {\r\n        if (!this.running) return;\r\n        this.rafId = requestAnimationFrame(this.loop);\r\n\r\n        let rawDt = (timestamp - this.lastTime) / 1000;\r\n        this.lastTime = timestamp;\r\n\r\n        // Clamp delta time\r\n        if (rawDt > this.maxDeltaTime) rawDt = this.maxDeltaTime;\r\n        this.frameTime = rawDt;\r\n\r\n        // FPS counter\r\n        this.fpsAccumulator += rawDt;\r\n        this.fpsFrames++;\r\n        if (this.fpsAccumulator >= 0.5) {\r\n            this.fps = Math.round(this.fpsFrames / this.fpsAccumulator);\r\n            this.fpsFrames = 0;\r\n            this.fpsAccumulator = 0;\r\n        }\r\n\r\n        // Fixed timestep update\r\n        this.accumulator += rawDt;\r\n        while (this.accumulator >= this.fixedDt) {\r\n            this.scenes.update(this.fixedDt);\r\n            this.accumulator -= this.fixedDt;\r\n        }\r\n        this.emit('update', { dt: rawDt, fixedDt: this.fixedDt });\r\n\r\n        // Render\r\n        this.scenes.render(this.renderer);\r\n        this.emit('render', { renderer: this.renderer });\r\n\r\n        // Reset per-frame input state\r\n        this.input.endFrame();\r\n    };\r\n}\r\n", "/**\r\n * Scene - Abstract base class for all game scenes\r\n */\r\nimport { Renderer } from '../renderer/Renderer.js';\r\nimport { InputManager } from '../input/InputManager.js';\r\nimport { Camera2D } from '../camera/Camera2D.js';\r\nimport { PhysicsWorld } from '../physics/PhysicsWorld.js';\r\n\r\nexport interface SceneContext {\r\n    renderer: Renderer;\r\n    input: InputManager;\r\n    camera: Camera2D;\r\n    physics: PhysicsWorld;\r\n}\r\n\r\nexport abstract class Scene {\r\n    protected ctx!: SceneContext;\r\n\r\n    /** Called when the scene is entered */\r\n    onEnter(_ctx: SceneContext): void { this.ctx = _ctx; }\r\n\r\n    /** Called when the scene is exited */\r\n    onExit(): void { }\r\n\r\n    /** Called each update tick */\r\n    abstract update(dt: number): void;\r\n\r\n    /** Called each render frame */\r\n    abstract render(renderer: Renderer): void;\r\n\r\n    /** Optional: handle resize events */\r\n    onResize(_width: number, _height: number): void { }\r\n}\r\n", "/**\r\n * ObjectPool - Generic object pool to minimize GC pressure\r\n */\r\nexport class ObjectPool<T> {\r\n    private pool: T[] = [];\r\n    private factory: () => T;\r\n    private reset: (obj: T) => void;\r\n    private maxSize: number;\r\n\r\n    constructor(factory: () => T, reset: (obj: T) => void, initialSize: number = 0, maxSize: number = 10000) {\r\n        this.factory = factory;\r\n        this.reset = reset;\r\n        this.maxSize = maxSize;\r\n        for (let i = 0; i < initialSize; i++) {\r\n            this.pool.push(factory());\r\n        }\r\n    }\r\n\r\n    acquire(): T {\r\n        if (this.pool.length > 0) {\r\n            return this.pool.pop()!;\r\n        }\r\n        return this.factory();\r\n    }\r\n\r\n    release(obj: T): void {\r\n        if (this.pool.length < this.maxSize) {\r\n            this.reset(obj);\r\n            this.pool.push(obj);\r\n        }\r\n    }\r\n\r\n    get available(): number { return this.pool.length; }\r\n\r\n    prewarm(count: number): void {\r\n        for (let i = 0; i < count; i++) {\r\n            this.pool.push(this.factory());\r\n        }\r\n    }\r\n\r\n    clear(): void { this.pool.length = 0; }\r\n}\r\n", "/**\r\n * QuadTree - Generic 2D spatial quadtree.\r\n *\r\n * Supports two modes:\r\n *   1. Point query / range query (collision broad-phase, spatial lookups)\r\n *   2. Barnes-Hut mode: stores center-of-mass for N-body gravity approximation\r\n *\r\n * Usage (spatial queries):\r\n *   const qt = new QuadTree(bounds, capacity);\r\n *   qt.insert({ x, y, data });\r\n *   const results = qt.queryRect(bounds);\r\n *   const results = qt.queryCircle(cx, cy, radius);\r\n *\r\n * Usage (Barnes-Hut, via BarnesHut class):\r\n *   qt.insert({ x, y, mass, data });\r\n *   // Each internal node accumulates mass and center-of-mass\r\n */\r\n\r\nexport interface QTBounds {\r\n    x: number;  // center X\r\n    y: number;  // center Y\r\n    hw: number; // half-width\r\n    hh: number; // half-height\r\n}\r\n\r\nexport interface QTPoint<T = unknown> {\r\n    x: number;\r\n    y: number;\r\n    mass?: number;\r\n    data?: T;\r\n}\r\n\r\n// \u2500\u2500\u2500 QuadTree Node (internal) \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\r\n\r\nclass QTNode<T> {\r\n    points: QTPoint<T>[] = [];\r\n    children: [QTNode<T>, QTNode<T>, QTNode<T>, QTNode<T>] | null = null;\r\n\r\n    // Barnes-Hut aggregates\r\n    totalMass: number = 0;\r\n    cx: number = 0;  // center of mass X\r\n    cy: number = 0;  // center of mass Y\r\n\r\n    constructor(public bounds: QTBounds) { }\r\n\r\n    get isLeaf(): boolean { return this.children === null; }\r\n    get isEmpty(): boolean { return this.points.length === 0 && this.isLeaf; }\r\n\r\n    contains(px: number, py: number): boolean {\r\n        const { x, y, hw, hh } = this.bounds;\r\n        return px >= x - hw && px <= x + hw && py >= y - hh && py <= y + hh;\r\n    }\r\n\r\n    intersectsRect(rx: number, ry: number, rw: number, rh: number): boolean {\r\n        const { x, y, hw, hh } = this.bounds;\r\n        return !(rx > x + hw || rx + rw < x - hw || ry > y + hh || ry + rh < y - hh);\r\n    }\r\n\r\n    intersectsCircle(cx: number, cy: number, r: number): boolean {\r\n        const { x, y, hw, hh } = this.bounds;\r\n        const nearX = Math.max(x - hw, Math.min(x + hw, cx));\r\n        const nearY = Math.max(y - hh, Math.min(y + hh, cy));\r\n        const dx = cx - nearX, dy = cy - nearY;\r\n        return dx * dx + dy * dy <= r * r;\r\n    }\r\n\r\n    split(): void {\r\n        const { x, y, hw, hh } = this.bounds;\r\n        const qw = hw * 0.5, qh = hh * 0.5;\r\n        this.children = [\r\n            new QTNode<T>({ x: x - qw, y: y - qh, hw: qw, hh: qh }), // NW\r\n            new QTNode<T>({ x: x + qw, y: y - qh, hw: qw, hh: qh }), // NE\r\n            new QTNode<T>({ x: x - qw, y: y + qh, hw: qw, hh: qh }), // SW\r\n            new QTNode<T>({ x: x + qw, y: y + qh, hw: qw, hh: qh }), // SE\r\n        ];\r\n    }\r\n\r\n    getChildFor(px: number, py: number): QTNode<T> | null {\r\n        if (!this.children) return null;\r\n        for (const child of this.children) {\r\n            if (child.contains(px, py)) return child;\r\n        }\r\n        return null;\r\n    }\r\n}\r\n\r\n// \u2500\u2500\u2500 QuadTree \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\r\n\r\nexport class QuadTree<T = unknown> {\r\n    private root: QTNode<T>;\r\n    private capacity: number;\r\n    private maxDepth: number;\r\n    private _size: number = 0;\r\n\r\n    /**\r\n     * @param bounds World-space bounds for the tree (center + half-extents)\r\n     * @param capacity Max points per node before splitting (4\u20138 is typical)\r\n     * @param maxDepth  Max tree depth (12\u201316 is typically safe)\r\n     */\r\n    constructor(bounds: QTBounds, capacity: number = 6, maxDepth: number = 12) {\r\n        this.root = new QTNode<T>(bounds);\r\n        this.capacity = capacity;\r\n        this.maxDepth = maxDepth;\r\n    }\r\n\r\n    get size(): number { return this._size; }\r\n\r\n    /** Remove all points and reset the tree */\r\n    clear(): void {\r\n        this.root = new QTNode<T>(this.root.bounds);\r\n        this._size = 0;\r\n    }\r\n\r\n    /** Resize the tree bounds (rebuilds root) */\r\n    resize(bounds: QTBounds): void {\r\n        this.root = new QTNode<T>(bounds);\r\n        this._size = 0;\r\n    }\r\n\r\n    // \u2500\u2500\u2500 Insert \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\r\n\r\n    insert(point: QTPoint<T>): boolean {\r\n        if (!this.root.contains(point.x, point.y)) return false;\r\n        this.insertInto(this.root, point, 0);\r\n        this._size++;\r\n        return true;\r\n    }\r\n\r\n    private insertInto(node: QTNode<T>, point: QTPoint<T>, depth: number): void {\r\n        // Update Barnes-Hut aggregates\r\n        const m = point.mass ?? 1;\r\n        const total = node.totalMass + m;\r\n        node.cx = (node.cx * node.totalMass + point.x * m) / total;\r\n        node.cy = (node.cy * node.totalMass + point.y * m) / total;\r\n        node.totalMass = total;\r\n\r\n        // Leaf: can fit\r\n        if (node.isLeaf && node.points.length < this.capacity) {\r\n            node.points.push(point);\r\n            return;\r\n        }\r\n\r\n        // Split if leaf at capacity and not at max depth\r\n        if (node.isLeaf && depth < this.maxDepth) {\r\n            node.split();\r\n            // Re-insert existing points into children\r\n            for (const p of node.points) {\r\n                const child = node.getChildFor(p.x, p.y);\r\n                if (child) this.insertInto(child, p, depth + 1);\r\n            }\r\n            node.points.length = 0;\r\n        }\r\n\r\n        // Insert into appropriate child\r\n        if (node.children) {\r\n            const child = node.getChildFor(point.x, point.y);\r\n            if (child) {\r\n                this.insertInto(child, point, depth + 1);\r\n            } else {\r\n                // Shouldn't happen \u2014 point is on boundary, insert in first matching\r\n                node.points.push(point);\r\n            }\r\n        } else {\r\n            // At max depth, store here\r\n            node.points.push(point);\r\n        }\r\n    }\r\n\r\n    // \u2500\u2500\u2500 Query: rectangle \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\r\n\r\n    queryRect(x: number, y: number, w: number, h: number, results: QTPoint<T>[] = []): QTPoint<T>[] {\r\n        this.queryRectNode(this.root, x, y, w, h, results);\r\n        return results;\r\n    }\r\n\r\n    private queryRectNode(node: QTNode<T>, rx: number, ry: number, rw: number, rh: number, results: QTPoint<T>[]): void {\r\n        if (!node.intersectsRect(rx, ry, rw, rh)) return;\r\n        for (const p of node.points) {\r\n            if (p.x >= rx && p.x <= rx + rw && p.y >= ry && p.y <= ry + rh) {\r\n                results.push(p);\r\n            }\r\n        }\r\n        if (node.children) {\r\n            for (const child of node.children) {\r\n                this.queryRectNode(child, rx, ry, rw, rh, results);\r\n            }\r\n        }\r\n    }\r\n\r\n    // \u2500\u2500\u2500 Query: circle \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\r\n\r\n    queryCircle(cx: number, cy: number, radius: number, results: QTPoint<T>[] = []): QTPoint<T>[] {\r\n        this.queryCircleNode(this.root, cx, cy, radius, radius * radius, results);\r\n        return results;\r\n    }\r\n\r\n    private queryCircleNode(\r\n        node: QTNode<T>, cx: number, cy: number, r: number, rSq: number, results: QTPoint<T>[]\r\n    ): void {\r\n        if (!node.intersectsCircle(cx, cy, r)) return;\r\n        for (const p of node.points) {\r\n            const dx = p.x - cx, dy = p.y - cy;\r\n            if (dx * dx + dy * dy <= rSq) results.push(p);\r\n        }\r\n        if (node.children) {\r\n            for (const child of node.children) {\r\n                this.queryCircleNode(child, cx, cy, r, rSq, results);\r\n            }\r\n        }\r\n    }\r\n\r\n    // \u2500\u2500\u2500 Query: nearest neighbor (approximate) \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\r\n\r\n    nearest(px: number, py: number): QTPoint<T> | null {\r\n        let best: QTPoint<T> | null = null;\r\n        let bestDSq = Infinity;\r\n        this.nearestNode(this.root, px, py, { best, bestDSq });\r\n        return best;\r\n    }\r\n\r\n    private nearestNode(node: QTNode<T>, px: number, py: number, state: { best: QTPoint<T> | null; bestDSq: number }): void {\r\n        for (const p of node.points) {\r\n            const dx = p.x - px, dy = p.y - py;\r\n            const dSq = dx * dx + dy * dy;\r\n            if (dSq < state.bestDSq) { state.bestDSq = dSq; state.best = p; }\r\n        }\r\n        if (node.children) {\r\n            // Sort children by proximity to point (visit closest first)\r\n            const sorted = [...node.children].sort((a, b) => {\r\n                const dA = (a.bounds.x - px) ** 2 + (a.bounds.y - py) ** 2;\r\n                const dB = (b.bounds.x - px) ** 2 + (b.bounds.y - py) ** 2;\r\n                return dA - dB;\r\n            });\r\n            for (const child of sorted) {\r\n                // Prune: if the child's AABB is farther than best distance, skip\r\n                const { x, y, hw, hh } = child.bounds;\r\n                const nearX = Math.max(x - hw, Math.min(x + hw, px));\r\n                const nearY = Math.max(y - hh, Math.min(y + hh, py));\r\n                const minDSq = (nearX - px) ** 2 + (nearY - py) ** 2;\r\n                if (minDSq > state.bestDSq) continue;\r\n                this.nearestNode(child, px, py, state);\r\n            }\r\n        }\r\n    }\r\n\r\n    // \u2500\u2500\u2500 Barnes-Hut traversal \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\r\n\r\n    /**\r\n     * Compute gravitational acceleration at (px, py) using Barnes-Hut approximation.\r\n     * @param px     Query point X\r\n     * @param py     Query point Y  \r\n     * @param G      Gravitational constant\r\n     * @param theta  Accuracy parameter (0.5-0.9, lower=more accurate)\r\n     * @param softening  Softening length to avoid singularity\r\n     */\r\n    barnesHutForce(\r\n        px: number, py: number,\r\n        G: number = 1, theta: number = 0.7, softening: number = 10\r\n    ): [number, number] {\r\n        let ax = 0, ay = 0;\r\n        this.bhForceNode(this.root, px, py, G, theta, softening * softening, ax, ay, (fx, fy) => {\r\n            ax += fx; ay += fy;\r\n        });\r\n        return [ax, ay];\r\n    }\r\n\r\n    private bhForceNode(\r\n        node: QTNode<T>, px: number, py: number,\r\n        G: number, theta: number, softSq: number,\r\n        _ax: number, _ay: number,\r\n        accumulate: (fx: number, fy: number) => void\r\n    ): void {\r\n        if (node.totalMass === 0) return;\r\n\r\n        const dx = node.cx - px;\r\n        const dy = node.cy - py;\r\n        const distSq = dx * dx + dy * dy + softSq;\r\n\r\n        if (distSq < 0.01) return; // same point, skip\r\n\r\n        const nodeSize = node.bounds.hw * 2;\r\n        const dist = Math.sqrt(distSq);\r\n\r\n        // Barnes-Hut criterion: s/d < theta  \u2192  treat as single mass\r\n        if (node.isLeaf || (nodeSize / dist) < theta) {\r\n            const forceMag = G * node.totalMass / distSq;\r\n            accumulate((dx / dist) * forceMag, (dy / dist) * forceMag);\r\n            return;\r\n        }\r\n\r\n        // Recurse into children\r\n        if (node.children) {\r\n            for (const child of node.children) {\r\n                this.bhForceNode(child, px, py, G, theta, softSq, _ax, _ay, accumulate);\r\n            }\r\n        }\r\n        // Also handle any points stored at this internal node (overflow)\r\n        for (const p of node.points) {\r\n            const pdx = p.x - px, pdy = p.y - py;\r\n            const pdistSq = pdx * pdx + pdy * pdy + softSq;\r\n            const pdist = Math.sqrt(pdistSq);\r\n            const forceMag = G * (p.mass ?? 1) / pdistSq;\r\n            accumulate((pdx / pdist) * forceMag, (pdy / pdist) * forceMag);\r\n        }\r\n    }\r\n\r\n    // \u2500\u2500\u2500 Diagnostics \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\r\n\r\n    getDepth(): number { return this.nodeDepth(this.root); }\r\n    private nodeDepth(node: QTNode<T>): number {\r\n        if (!node.children) return 1;\r\n        return 1 + Math.max(...node.children.map(c => this.nodeDepth(c)));\r\n    }\r\n\r\n    getNodeCount(): number { return this.countNodes(this.root); }\r\n    private countNodes(node: QTNode<T>): number {\r\n        if (!node.children) return 1;\r\n        return 1 + node.children.reduce((s, c) => s + this.countNodes(c), 0);\r\n    }\r\n}\r\n", "/**\r\n * PhysicsBody - A point-mass rigid body\r\n */\r\nimport { Vector2 } from '../math/Vector2.js';\r\n\r\nexport class PhysicsBody {\r\n    position: Vector2;\r\n    velocity: Vector2;\r\n    acceleration: Vector2;\r\n    mass: number;\r\n    inverseMass: number;\r\n    damping: number;\r\n    isStatic: boolean;\r\n\r\n    constructor(x: number = 0, y: number = 0, mass: number = 1) {\r\n        this.position = new Vector2(x, y);\r\n        this.velocity = Vector2.zero();\r\n        this.acceleration = Vector2.zero();\r\n        this.mass = mass;\r\n        this.inverseMass = mass > 0 ? 1 / mass : 0;\r\n        this.damping = 0.9999;\r\n        this.isStatic = mass <= 0;\r\n    }\r\n\r\n    applyForce(force: Vector2): void {\r\n        if (this.isStatic) return;\r\n        // F = ma => a = F/m\r\n        this.acceleration.x += force.x * this.inverseMass;\r\n        this.acceleration.y += force.y * this.inverseMass;\r\n    }\r\n\r\n    applyImpulse(impulse: Vector2): void {\r\n        if (this.isStatic) return;\r\n        this.velocity.x += impulse.x * this.inverseMass;\r\n        this.velocity.y += impulse.y * this.inverseMass;\r\n    }\r\n\r\n    integrate(dt: number): void {\r\n        if (this.isStatic) return;\r\n\r\n        // Symplectic Euler integration\r\n        this.velocity.x += this.acceleration.x * dt;\r\n        this.velocity.y += this.acceleration.y * dt;\r\n\r\n        // Apply damping\r\n        this.velocity.x *= Math.pow(this.damping, dt);\r\n        this.velocity.y *= Math.pow(this.damping, dt);\r\n\r\n        this.position.x += this.velocity.x * dt;\r\n        this.position.y += this.velocity.y * dt;\r\n\r\n        // Reset acceleration\r\n        this.acceleration.x = 0;\r\n        this.acceleration.y = 0;\r\n    }\r\n\r\n    get speed(): number { return this.velocity.magnitude(); }\r\n\r\n    reset(): void {\r\n        this.position.set(0, 0);\r\n        this.velocity.set(0, 0);\r\n        this.acceleration.set(0, 0);\r\n        this.mass = 1;\r\n        this.inverseMass = 1;\r\n        this.damping = 0.9999;\r\n        this.isStatic = false;\r\n    }\r\n}\r\n", "/**\r\n * GalaxyParticle - Extended physics body for galaxy simulation\r\n */\r\nimport { PhysicsBody } from '../engine/physics/PhysicsBody.js';\r\n\r\nexport type ParticleType = 'star' | 'dust' | 'nebula' | 'core';\r\n\r\nexport class GalaxyParticle extends PhysicsBody {\r\n    r: number = 0;\r\n    g: number = 0;\r\n    b: number = 0;\r\n    alpha: number = 1;\r\n    size: number = 1;\r\n    type: ParticleType = 'star';\r\n    armIndex: number = 0;\r\n    age: number = 0;\r\n    orbitRadius: number = 0;\r\n    active: boolean = false;\r\n    colorPhase: number = 0;\r\n    /** 3D height in galactic disc plane (world units) */\r\n    z: number = 0;\r\n    vz: number = 0; // Z velocity for 3D formation animation\r\n\r\n\r\n    constructor() {\r\n        super(0, 0, 1);\r\n    }\r\n\r\n    get cssColor(): string {\r\n        return `rgba(${this.r | 0},${this.g | 0},${this.b | 0},${this.alpha.toFixed(3)})`;\r\n    }\r\n\r\n    override reset(): void {\r\n        super.reset();\r\n        this.r = 255; this.g = 255; this.b = 255; this.alpha = 1;\r\n        this.size = 1;\r\n        this.type = 'star';\r\n        this.armIndex = 0;\r\n        this.age = 0;\r\n        this.orbitRadius = 0;\r\n        this.active = false;\r\n        this.colorPhase = 0;\r\n    }\r\n}\r\n\r\n", "\uFEFF/**\r\n * GalaxyScene v5\r\n *\r\n * Key design changes from v4:\r\n * - Physics ALWAYS starts at correct orbital positions (original behaviour)\r\n * - Formation animation is visual-only: display position lerps from a random\r\n *   3D-sphere (\"chaos\") to the physics position over formationDuration seconds.\r\n *   No chaotic physics, no velocity nudging.\r\n * - Stars are crisp 1-pixel dots, no square kernel, glow only for large stars.\r\n * - AdditiveBlend removed from multi-overlap near center \u2192 no over-bright blob.\r\n * - 3D orbit: right-click drag to pitch/yaw, left drag to pan, scroll to zoom.\r\n */\r\n\r\nimport { Scene, SceneContext } from '../engine/scene/Scene.js';\r\nimport { Renderer } from '../engine/renderer/Renderer.js';\r\nimport { Vector2 } from '../engine/math/Vector2.js';\r\nimport { MathUtils } from '../engine/math/MathUtils.js';\r\nimport { ObjectPool } from '../engine/commons/ObjectPool.js';\r\nimport { QuadTree } from '../engine/spatial/QuadTree.js';\r\nimport { GalaxyParticle } from './GalaxyParticle.js';\r\n\r\n// ---- Config ----------------------------------------------------------------\r\n\r\nexport interface MilkyWayConfig {\r\n    starCount: number;\r\n    dustCount: number;\r\n    galaxyRadius: number;\r\n    coreRadius: number;\r\n    blackHoleMass: number;\r\n    G: number;\r\n    simSpeed: number;\r\n    formationDuration: number;\r\n}\r\n\r\nconst DEF: MilkyWayConfig = {\r\n    starCount: 12000,\r\n    dustCount: 2000,\r\n    galaxyRadius: 2400,\r\n    coreRadius: 200,\r\n    blackHoleMass: 2_200_000,\r\n    G: 6.674e-3,\r\n    simSpeed: 1.0,\r\n    formationDuration: 18,\r\n};\r\n\r\n// ---- Arms / colours --------------------------------------------------------\r\n\r\ninterface Arm { base: number; pitch: number; }\r\nconst ARMS: Arm[] = [\r\n    { base: 0, pitch: 0.22 },\r\n    { base: Math.PI / 2, pitch: 0.20 },\r\n    { base: Math.PI, pitch: 0.21 },\r\n    { base: 3 * Math.PI / 2, pitch: 0.19 },\r\n];\r\n\r\nconst TEMPS: [number, number, number][] = [\r\n    [155, 176, 255], [170, 191, 255], [202, 215, 255], [248, 247, 255],\r\n    [255, 244, 232], [255, 222, 162], [255, 185, 95], [255, 140, 60],\r\n];\r\n\r\nconst NEBULA_COL: [number, number, number][] = [\r\n    [80, 30, 140], [20, 60, 180], [180, 30, 60], [30, 100, 150], [140, 50, 180],\r\n];\r\n\r\n// ---- Scene -----------------------------------------------------------------\r\n\r\nexport class GalaxyScene extends Scene {\r\n    private cfg: MilkyWayConfig;\r\n    private particles: GalaxyParticle[] = [];\r\n    private pool: ObjectPool<GalaxyParticle>;\r\n    private qt!: QuadTree<GalaxyParticle>;\r\n\r\n    // 3D view\r\n    private pitch = Math.PI / 9;   // ~20\u00B0 initial tilt so disc depth is visible\r\n    private yaw = 0.0;\r\n    private panX = 0.0;\r\n    private panY = 0.0;\r\n    private zoom = 0.12;          // start showing the full formed galaxy\r\n\r\n    // Input\r\n    private panning = false;\r\n    private orbiting = false;\r\n    private mx = 0; private my = 0;\r\n\r\n    // Formation \u2013 visual only (chaos positions separate from physics positions)\r\n    private formT = 0.0;\r\n    private formed = false;\r\n    private chaosX!: Float32Array;\r\n    private chaosY!: Float32Array;\r\n    private chaosZ!: Float32Array;\r\n\r\n    private time = 0.0;\r\n    private bgStars: { x: number; y: number; r: number; a: number }[] = [];\r\n\r\n    fpsRef: { fps: number } = { fps: 0 };\r\n\r\n    constructor(config?: Partial<MilkyWayConfig>) {\r\n        super();\r\n        this.cfg = Object.assign({}, DEF, config);\r\n        this.pool = new ObjectPool<GalaxyParticle>(() => new GalaxyParticle(), p => p.reset(), 16000);\r\n    }\r\n\r\n    override onEnter(ctx: SceneContext): void {\r\n        super.onEnter(ctx);\r\n        this.initQt();\r\n        this.spawn();\r\n        this.buildUI();\r\n        this.bindInput();\r\n    }\r\n    override onExit(): void {\r\n        this.freeAll();\r\n        document.getElementById('galaxy-ui')?.remove();\r\n        this.ctx.input.removeAllListeners();\r\n    }\r\n\r\n    // ---- 3D projection (inline-friendly helper) ------------------------------\r\n\r\n    private proj(wx: number, wy: number, wz: number, W: number, H: number): { sx: number; sy: number } {\r\n        const cy = Math.cos(this.yaw), sy = Math.sin(this.yaw);\r\n        const cp = Math.cos(this.pitch), sp = Math.sin(this.pitch);\r\n        const rx = wx * cy + wy * sy;\r\n        const ry = -wx * sy + wy * cy;\r\n        const projY = ry * cp - wz * sp;\r\n        return {\r\n            sx: (rx - this.panX) * this.zoom + W * 0.5,\r\n            sy: (projY - this.panY) * this.zoom + H * 0.5,\r\n        };\r\n    }\r\n\r\n    // ---- Init ----------------------------------------------------------------\r\n\r\n    private initQt(): void {\r\n        const R = this.cfg.galaxyRadius * 2;\r\n        this.qt = new QuadTree<GalaxyParticle>({ x: 0, y: 0, hw: R, hh: R }, 8, 14);\r\n    }\r\n    private freeAll(): void {\r\n        for (const p of this.particles) this.pool.release(p);\r\n        this.particles.length = 0;\r\n    }\r\n\r\n    // ---- Spawn ---------------------------------------------------------------\r\n    // Physics positions = correct orbital positions from the start.\r\n    // Chaos positions   = random 3D sphere = visual-only for formation animation.\r\n\r\n    private spawn(): void {\r\n        this.freeAll();\r\n        this.formT = 0;\r\n        this.formed = false;\r\n        const cfg = this.cfg;\r\n        const total = cfg.starCount + cfg.dustCount;\r\n        this.chaosX = new Float32Array(total);\r\n        this.chaosY = new Float32Array(total);\r\n        this.chaosZ = new Float32Array(total);\r\n\r\n        let idx = 0;\r\n\r\n        // Core bulge \u2013 make it a proper 3D ellipsoid, not a flat disc\r\n        const coreN = Math.floor(cfg.starCount * 0.18);\r\n        for (let i = 0; i < coreN; i++, idx++) {\r\n            const r = Math.abs(MathUtils.gaussianRandom(0, cfg.coreRadius * 0.5));\r\n            const a = Math.random() * MathUtils.PI2;\r\n            this.makeParticle(idx, r * Math.cos(a), r * Math.sin(a),\r\n                MathUtils.gaussianRandom(0, cfg.coreRadius * 0.45), a, r, 'core', 0);\r\n        }\r\n\r\n        // Central bar\r\n        const barN = Math.floor(cfg.starCount * 0.07);\r\n        const bAng = 0.25;\r\n        for (let i = 0; i < barN; i++, idx++) {\r\n            const along = MathUtils.gaussianRandom(0, cfg.coreRadius * 1.5);\r\n            const perp = MathUtils.gaussianRandom(0, cfg.coreRadius * 0.14);\r\n            const tx = Math.cos(bAng) * along - Math.sin(bAng) * perp;\r\n            const ty = Math.sin(bAng) * along + Math.cos(bAng) * perp;\r\n            const r = Math.sqrt(tx * tx + ty * ty);\r\n            const a = Math.atan2(ty, tx);\r\n            this.makeParticle(idx, tx, ty, MathUtils.gaussianRandom(0, cfg.coreRadius * 0.30), a, r, 'core', 0);\r\n        }\r\n\r\n        // Spiral arms \u2013 disc thickness tapers with radius (thick near core, thin at edge)\r\n        const armN = cfg.starCount - coreN - barN;\r\n        const perArm = Math.floor(armN / ARMS.length);\r\n        for (let ai = 0; ai < ARMS.length; ai++) {\r\n            for (let i = 0; i < perArm; i++, idx++) {\r\n                const { tx, ty, ang, r } = this.sampleArm(ARMS[ai]);\r\n                // 0.10 gives a disc ~240 units thick at mid-radius \u2014 clearly visible from side\r\n                const dzScale = cfg.galaxyRadius * 0.10 * (0.8 - 0.65 * (r / cfg.galaxyRadius));\r\n                const dz = MathUtils.gaussianRandom(0, Math.max(dzScale, cfg.coreRadius * 0.05));\r\n                this.makeParticle(idx, tx, ty, dz, ang, r, 'star', ai);\r\n            }\r\n        }\r\n\r\n        // Dust / nebula \u2013 same disc thickness as stars\r\n        for (let i = 0; i < cfg.dustCount; i++, idx++) {\r\n            const arm = ARMS[i % ARMS.length];\r\n            const { tx, ty, ang, r } = this.sampleArm(arm, 1.6);\r\n            const type = (i % 5 === 0) ? 'nebula' : 'dust';\r\n            const dzScale = cfg.galaxyRadius * 0.09 * (0.8 - 0.60 * (r / cfg.galaxyRadius));\r\n            this.makeParticle(idx, tx, ty, MathUtils.gaussianRandom(0, Math.max(dzScale, cfg.coreRadius * 0.04)),\r\n                ang, r, type as GalaxyParticle['type'], i % ARMS.length);\r\n        }\r\n    }\r\n\r\n    private makeParticle(\r\n        idx: number,\r\n        tx: number, ty: number, tz: number,\r\n        ang: number, r: number,\r\n        type: GalaxyParticle['type'], ai: number\r\n    ): void {\r\n        const p = this.pool.acquire();\r\n        const cfg = this.cfg;\r\n\r\n        // Physics \u2192 start at correct orbital position & velocity\r\n        p.position.x = tx;\r\n        p.position.y = ty;\r\n        p.z = tz;\r\n        const orbV = Math.sqrt(cfg.G * cfg.blackHoleMass / Math.max(r, 5));\r\n        p.velocity.x = -Math.sin(ang) * orbV;\r\n        p.velocity.y = Math.cos(ang) * orbV;\r\n        p.vz = 0;\r\n\r\n        // Chaos position \u2192 random point in a 3D sphere, truly all-directions\r\n        // Radius randomly between 400 and 6000 world units.\r\n        const chaosR = MathUtils.randomRange(200, 6000);\r\n        const chaosAz = Math.random() * MathUtils.PI2;             // azimuth\r\n        const chaosEl = (Math.random() - 0.5) * Math.PI;           // elevation -90..+90\r\n        this.chaosX[idx] = Math.cos(chaosEl) * Math.cos(chaosAz) * chaosR;\r\n        this.chaosY[idx] = Math.cos(chaosEl) * Math.sin(chaosAz) * chaosR;\r\n        this.chaosZ[idx] = Math.sin(chaosEl) * chaosR;\r\n\r\n        p.type = type;\r\n        p.armIndex = ai;\r\n        p.orbitRadius = r;\r\n        p.active = true;\r\n        p.age = Math.random() * 50;\r\n        p.colorPhase = Math.random() * MathUtils.PI2;\r\n        p.mass = 1; p.inverseMass = 1;\r\n\r\n        this.colorP(p, r, type, ai);\r\n        this.sizeP(p, type);\r\n        this.particles.push(p);\r\n    }\r\n\r\n    private sampleArm(arm: Arm, spreadMult = 1): { tx: number; ty: number; ang: number; r: number } {\r\n        const cfg = this.cfg;\r\n        // Bias toward inner\u2013mid radii so arms taper outward naturally\r\n        const t = Math.pow(Math.random(), 0.55);\r\n        const r = MathUtils.lerp(cfg.coreRadius * 0.5, cfg.galaxyRadius, t);\r\n        const theta = arm.base + (1 / arm.pitch) * Math.log(r / (cfg.coreRadius * 0.35) + 1);\r\n        // Increased base spread (0.32) so stars scatter much more broadly around\r\n        // the arm centreline \u2014 no more tight visible ring gaps.\r\n        const spread = MathUtils.gaussianRandom(0, 0.32 * spreadMult * (0.25 + t * 0.75));\r\n        const ang = theta + spread;\r\n        // Scatter radial position too so rings don't pile up at exact r values\r\n        const rScatter = r + MathUtils.gaussianRandom(0, r * 0.06);\r\n        return { tx: Math.cos(ang) * rScatter, ty: Math.sin(ang) * rScatter, ang, r: rScatter };\r\n    }\r\n\r\n    private colorP(p: GalaxyParticle, r: number, type: GalaxyParticle['type'], ai: number): void {\r\n        const nr = MathUtils.clamp(r / this.cfg.galaxyRadius, 0, 1);\r\n        if (type === 'nebula') {\r\n            const c = NEBULA_COL[Math.floor(Math.random() * NEBULA_COL.length)];\r\n            p.r = c[0]; p.g = c[1]; p.b = c[2]; return;\r\n        }\r\n        if (type === 'dust') {\r\n            p.r = MathUtils.randomRange(150, 195); p.g = MathUtils.randomRange(80, 125); p.b = MathUtils.randomRange(35, 75); return;\r\n        }\r\n        if (type === 'core') {\r\n            const c = TEMPS[Math.floor(Math.random() * 3)];\r\n            p.r = c[0]; p.g = c[1]; p.b = c[2]; return;\r\n        }\r\n        const ci = MathUtils.clamp(nr * 1.2 + MathUtils.gaussianRandom(0, 0.16), 0, 1) * (TEMPS.length - 1);\r\n        const lo = Math.floor(ci), hi = Math.min(lo + 1, TEMPS.length - 1);\r\n        const frac = ci - lo;\r\n        const ca = TEMPS[lo], cb = TEMPS[hi];\r\n        p.r = MathUtils.lerp(ca[0], cb[0], frac);\r\n        p.g = MathUtils.lerp(ca[1], cb[1], frac);\r\n        p.b = MathUtils.lerp(ca[2], cb[2], frac);\r\n    }\r\n\r\n    private sizeP(p: GalaxyParticle, type: GalaxyParticle['type']): void {\r\n        if (type === 'core') { p.size = MathUtils.randomRange(1.0, 2.5); p.alpha = MathUtils.randomRange(0.6, 0.9); }\r\n        else if (type === 'star') { p.size = MathUtils.randomRange(0.7, 2.0); p.alpha = MathUtils.randomRange(0.45, 0.85); }\r\n        else if (type === 'dust') { p.size = MathUtils.randomRange(0.8, 2.2); p.alpha = MathUtils.randomRange(0.03, 0.10); }\r\n        else { p.size = MathUtils.randomRange(50, 200); p.alpha = MathUtils.randomRange(0.008, 0.03); }\r\n    }\r\n\r\n    // ---- Input ---------------------------------------------------------------\r\n\r\n    private bindInput(): void {\r\n        const canvas = this.ctx.renderer.canvas;\r\n        canvas.addEventListener('mousedown', e => {\r\n            // Left-drag = orbit 3D  |  Right-drag = pan\r\n            if (e.button === 0) this.orbiting = true;\r\n            if (e.button === 2) this.panning = true;\r\n            this.mx = e.clientX; this.my = e.clientY;\r\n        });\r\n        window.addEventListener('mouseup', () => { this.panning = false; this.orbiting = false; });\r\n        window.addEventListener('mousemove', e => {\r\n            const dx = e.clientX - this.mx, dy = e.clientY - this.my;\r\n            this.mx = e.clientX; this.my = e.clientY;\r\n            if (this.orbiting) {\r\n                this.yaw += dx * 0.006;\r\n                this.pitch = MathUtils.clamp(this.pitch + dy * 0.004, -Math.PI * 0.499, Math.PI * 0.499);\r\n            }\r\n            if (this.panning) { this.panX -= dx / this.zoom; this.panY -= dy / this.zoom; }\r\n        });\r\n        canvas.addEventListener('contextmenu', e => e.preventDefault());\r\n        canvas.addEventListener('wheel', e => {\r\n            e.preventDefault();\r\n            const f = e.deltaY > 0 ? 0.88 : 1 / 0.88;\r\n            this.zoom = MathUtils.clamp(this.zoom * f, 0.004, 5);\r\n        }, { passive: false });\r\n    }\r\n\r\n    // ---- Update --------------------------------------------------------------\r\n\r\n    override update(dt: number): void {\r\n        const cfg = this.cfg;\r\n        const sdt = Math.min(dt, 0.033) * cfg.simSpeed;\r\n        this.time += sdt;\r\n\r\n        if (!this.formed) {\r\n            this.formT += dt;\r\n            if (this.formT >= cfg.formationDuration) this.formed = true;\r\n        }\r\n\r\n        this.qt.clear();\r\n        for (const p of this.particles) {\r\n            if (p.active) this.qt.insert({ x: p.position.x, y: p.position.y, mass: p.mass, data: p });\r\n        }\r\n\r\n        const G = cfg.G, M = cfg.blackHoleMass;\r\n        const softSq = (cfg.coreRadius * 0.25) ** 2;\r\n        const maxAcc = 4000;\r\n\r\n        for (let i = 0; i < this.particles.length; i++) {\r\n            const p = this.particles[i];\r\n            if (!p.active) continue;\r\n\r\n            // Black hole gravity\r\n            const dx = -p.position.x, dy = -p.position.y;\r\n            const ds = dx * dx + dy * dy + softSq;\r\n            const d = Math.sqrt(ds);\r\n            let acc = G * M / ds;\r\n            if (acc > maxAcc) acc = maxAcc;\r\n            p.velocity.x += (dx / d) * acc * sdt;\r\n            p.velocity.y += (dy / d) * acc * sdt;\r\n\r\n            // Very subtle disc-plane restoring \u2014 much weaker so the 3D thickness is\r\n            // preserved. Coefficient 0.008 (was 0.12) means the disc oscillates slowly\r\n            // rather than snapping flat every frame.\r\n            p.vz += (-p.z * 0.008 - p.vz * 0.18) * sdt;\r\n            p.z += p.vz * sdt;\r\n\r\n            p.position.x += p.velocity.x * sdt;\r\n            p.position.y += p.velocity.y * sdt;\r\n            p.age += sdt;\r\n\r\n            // Twinkle\r\n            if (p.type === 'star' || p.type === 'core') {\r\n                p.colorPhase += sdt * 0.35;\r\n                const tw = 0.88 + 0.12 * Math.sin(p.colorPhase);\r\n                p.alpha = MathUtils.clamp((p.type === 'core' ? 0.62 : 0.56) * tw, 0.06, 0.88);\r\n            }\r\n        }\r\n    }\r\n\r\n    // ---- Render --------------------------------------------------------------\r\n\r\n    override render(renderer: Renderer): void {\r\n        const ctx = renderer.ctx;\r\n        const W = renderer.width;\r\n        const H = renderer.height;\r\n        const pr = window.devicePixelRatio || 1;\r\n\r\n        renderer.clear('#000004');\r\n        renderer.resetTransform();\r\n        this.drawBgStars(ctx, W, H);\r\n\r\n        // Formation ease value (0 = chaos spawn, 1 = final orbit)\r\n        const formEase = this.formed ? 1.0\r\n            : MathUtils.smootherstep(0, 1, Math.min(this.formT / this.cfg.formationDuration, 1.0));\r\n\r\n        // Pre-compute 3D constants\r\n        const cy_ = Math.cos(this.yaw), sy_ = Math.sin(this.yaw);\r\n        const cp_ = Math.cos(this.pitch), sp_ = Math.sin(this.pitch);\r\n        const z_ = this.zoom;\r\n        const oX = W * 0.5;\r\n        const oY = H * 0.5;\r\n\r\n        // ---- ImageData pass: one crisp pixel per star --------------------------\r\n        const PW = W * pr | 0;\r\n        const PH = H * pr | 0;\r\n        const img = ctx.createImageData(PW, PH);\r\n        const buf = img.data;\r\n\r\n        const LARGE: GalaxyParticle[] = [];\r\n\r\n        for (let i = 0; i < this.particles.length; i++) {\r\n            const p = this.particles[i];\r\n            if (!p.active || p.type === 'nebula') continue;\r\n\r\n            // Display position = lerp(chaos, physics)\r\n            const wx = MathUtils.lerp(this.chaosX[i], p.position.x, formEase);\r\n            const wy = MathUtils.lerp(this.chaosY[i], p.position.y, formEase);\r\n            const wz = MathUtils.lerp(this.chaosZ[i], p.z, formEase);\r\n\r\n            // 3D \u2192 screen\r\n            const rx = wx * cy_ + wy * sy_;\r\n            const ry = -wx * sy_ + wy * cy_;\r\n            const projY = ry * cp_ - wz * sp_;\r\n            const sx = (rx - this.panX) * z_ + oX;\r\n            const sy3 = (projY - this.panY) * z_ + oY;\r\n\r\n            // Screen size of this particle\r\n            const sr = p.size * z_;\r\n\r\n            // Broad cull\r\n            if (sx < -sr * 2 || sx > W + sr * 2 || sy3 < -sr * 2 || sy3 > H + sr * 2) continue;\r\n\r\n            const screenPhysPx = sr * pr; // size in physical pixels\r\n\r\n            if (screenPhysPx > 4 && p.type !== 'dust') {\r\n                // Large/bright \u2014 collect for gradient pass\r\n                (p as any)._sx = sx;\r\n                (p as any)._sy = sy3;\r\n                (p as any)._sr = sr;\r\n                LARGE.push(p);\r\n            } else {\r\n                // Single crisp pixel (or 2\u00D72 max for medium stars)\r\n                const px2 = sx * pr | 0;\r\n                const py2 = sy3 * pr | 0;\r\n\r\n                // Clamp alpha: never full-white in centre, cap to avoid blooms\r\n                const drawA = Math.min(p.alpha, 0.72);\r\n                const aInt = (drawA * 255) | 0;\r\n                const rr = p.r | 0, gg = p.g | 0, bb = p.b | 0;\r\n\r\n                // Blit 1 pixel (or 2\u00D72 if medium)\r\n                const half = screenPhysPx > 1.8 ? 1 : 0;\r\n                for (let dy2 = -half; dy2 <= half; dy2++) {\r\n                    for (let dx2 = -half; dx2 <= half; dx2++) {\r\n                        const ppx = px2 + dx2, ppy = py2 + dy2;\r\n                        if (ppx < 0 || ppx >= PW || ppy < 0 || ppy >= PH) continue;\r\n                        const off = (ppy * PW + ppx) * 4;\r\n                        // Plain alpha-max blend (no additive \u2014 prevents over-bright core)\r\n                        if (aInt > buf[off + 3]) {\r\n                            buf[off] = rr;\r\n                            buf[off + 1] = gg;\r\n                            buf[off + 2] = bb;\r\n                            buf[off + 3] = aInt;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // Flush pixel buffer (identity = physical pixels)\r\n        ctx.setTransform(1, 0, 0, 1, 0, 0);\r\n        ctx.putImageData(img, 0, 0);\r\n\r\n        // ---- Gradient pass: large stars only -----------------------------------\r\n        ctx.setTransform(pr, 0, 0, pr, 0, 0);\r\n        ctx.globalCompositeOperation = 'screen';\r\n        for (const p of LARGE) {\r\n            const sx = (p as any)._sx as number;\r\n            const sy3 = (p as any)._sy as number;\r\n            const glowR = Math.min((p as any)._sr as number * 2.4, 10); // cap at 10px\r\n            ctx.globalAlpha = 1;\r\n            const grd = ctx.createRadialGradient(sx, sy3, 0, sx, sy3, glowR);\r\n            const alpha = (p.alpha * 0.85).toFixed(3);\r\n            const alpha2 = (p.alpha * 0.15).toFixed(3);\r\n            grd.addColorStop(0, `rgba(${p.r | 0},${p.g | 0},${p.b | 0},${alpha})`);\r\n            grd.addColorStop(0.45, `rgba(${p.r | 0},${p.g | 0},${p.b | 0},${alpha2})`);\r\n            grd.addColorStop(1, 'rgba(0,0,0,0)');\r\n            ctx.fillStyle = grd;\r\n            ctx.beginPath(); ctx.arc(sx, sy3, glowR, 0, MathUtils.PI2); ctx.fill();\r\n        }\r\n\r\n        // ---- Nebula pass -------------------------------------------------------\r\n        ctx.globalCompositeOperation = 'screen';\r\n        for (let i = 0; i < this.particles.length; i++) {\r\n            const p = this.particles[i];\r\n            if (p.type !== 'nebula') continue;\r\n            const wx = MathUtils.lerp(this.chaosX[i], p.position.x, formEase);\r\n            const wy = MathUtils.lerp(this.chaosY[i], p.position.y, formEase);\r\n            const wz = MathUtils.lerp(this.chaosZ[i], p.z, formEase);\r\n            const { sx, sy } = this.proj(wx, wy, wz, W, H);\r\n            const nr = p.size * this.zoom;\r\n            if (sx + nr < 0 || sx - nr > W || sy + nr < 0 || sy - nr > H) continue;\r\n            ctx.globalAlpha = p.alpha;\r\n            const grd = ctx.createRadialGradient(sx, sy, 0, sx, sy, nr);\r\n            grd.addColorStop(0, `rgba(${p.r | 0},${p.g | 0},${p.b | 0},0.7)`);\r\n            grd.addColorStop(0.55, `rgba(${p.r | 0},${p.g | 0},${p.b | 0},0.15)`);\r\n            grd.addColorStop(1, 'rgba(0,0,0,0)');\r\n            ctx.fillStyle = grd;\r\n            ctx.beginPath(); ctx.arc(sx, sy, nr, 0, MathUtils.PI2); ctx.fill();\r\n        }\r\n\r\n        // ---- Black hole --------------------------------------------------------\r\n        ctx.globalAlpha = 1;\r\n        this.drawBH(ctx, W, H);\r\n\r\n        // ---- HUD ---------------------------------------------------------------\r\n        ctx.globalAlpha = 1;\r\n        ctx.globalCompositeOperation = 'source-over';\r\n        this.drawHUD(ctx, W, H);\r\n        this.drawFormBar(ctx, W, H);\r\n    }\r\n\r\n    // ---- Helpers -------------------------------------------------------------\r\n\r\n    private drawBgStars(ctx: CanvasRenderingContext2D, W: number, H: number): void {\r\n        if (this.bgStars.length === 0) {\r\n            for (let i = 0; i < 500; i++) {\r\n                this.bgStars.push({\r\n                    x: Math.random(), y: Math.random(),\r\n                    r: MathUtils.randomRange(0.1, 0.45), a: MathUtils.randomRange(0.04, 0.22)\r\n                });\r\n            }\r\n        }\r\n        ctx.globalCompositeOperation = 'source-over';\r\n        ctx.fillStyle = '#ffffff';\r\n        for (const s of this.bgStars) {\r\n            ctx.globalAlpha = s.a + 0.04 * Math.sin(this.time * 0.3 + s.x * 80);\r\n            ctx.beginPath(); ctx.arc(s.x * W, s.y * H, s.r, 0, MathUtils.PI2); ctx.fill();\r\n        }\r\n        ctx.globalAlpha = 1;\r\n    }\r\n\r\n    private drawBH(ctx: CanvasRenderingContext2D, W: number, H: number): void {\r\n        ctx.setTransform(window.devicePixelRatio || 1, 0, 0, window.devicePixelRatio || 1, 0, 0);\r\n        const { sx, sy } = this.proj(0, 0, 0, W, H);\r\n        const cr = this.cfg.coreRadius;\r\n        const ringR = cr * 0.36 * this.zoom;\r\n        if (ringR < 1) return;\r\n\r\n        // Tight accretion ring (NOT a giant blob)\r\n        ctx.globalCompositeOperation = 'screen';\r\n        const ring = ctx.createRadialGradient(sx, sy, ringR * 0.12, sx, sy, ringR);\r\n        ring.addColorStop(0, 'rgba(255,255,255,0)');\r\n        ring.addColorStop(0.28, 'rgba(255,240,200,0.6)');\r\n        ring.addColorStop(0.62, 'rgba(255,120,35,0.3)');\r\n        ring.addColorStop(1, 'rgba(0,0,0,0)');\r\n        ctx.fillStyle = ring;\r\n        ctx.beginPath(); ctx.arc(sx, sy, ringR, 0, MathUtils.PI2); ctx.fill();\r\n\r\n        // Hard event horizon (dark disc hiding everything behind it)\r\n        ctx.globalCompositeOperation = 'source-over';\r\n        const bhR = Math.max(ringR * 0.13, 2);\r\n        const bh = ctx.createRadialGradient(sx, sy, 0, sx, sy, bhR * 2.2);\r\n        bh.addColorStop(0, '#000000');\r\n        bh.addColorStop(0.65, '#000000');\r\n        bh.addColorStop(1, 'rgba(0,0,0,0)');\r\n        ctx.fillStyle = bh;\r\n        ctx.beginPath(); ctx.arc(sx, sy, bhR * 2.2, 0, MathUtils.PI2); ctx.fill();\r\n    }\r\n\r\n    private drawHUD(ctx: CanvasRenderingContext2D, W: number, H: number): void {\r\n        const d = (r: number) => Math.round(r * 180 / Math.PI);\r\n        ctx.globalAlpha = 0.32;\r\n        ctx.fillStyle = '#b8bcff';\r\n        ctx.font = '11px Inter, system-ui, sans-serif';\r\n        ctx.textAlign = 'left';\r\n        ctx.fillText(\r\n            `AntiGravity Engine  |  ${this.particles.length.toLocaleString()} particles  |  ${this.fpsRef.fps} FPS  |  ${this.zoom.toFixed(3)}x  |  pitch ${d(this.pitch)}  yaw ${d(this.yaw % MathUtils.PI2)}`,\r\n            14, H - 16\r\n        );\r\n        ctx.globalAlpha = 1;\r\n    }\r\n\r\n    private drawFormBar(ctx: CanvasRenderingContext2D, W: number, H: number): void {\r\n        if (this.formed) return;\r\n        const t = Math.min(this.formT / this.cfg.formationDuration, 1.0);\r\n        const bw = 220, bh_ = 4, bx = (W - bw) / 2, by = H - 50;\r\n        ctx.globalAlpha = 0.5;\r\n        ctx.fillStyle = 'rgba(255,255,255,0.07)';\r\n        ctx.beginPath(); ctx.roundRect(bx, by, bw, bh_, 2); ctx.fill();\r\n        ctx.fillStyle = '#8b7ff5';\r\n        ctx.beginPath(); ctx.roundRect(bx, by, bw * t, bh_, 2); ctx.fill();\r\n        ctx.globalAlpha = 0.42;\r\n        ctx.fillStyle = 'rgba(180,180,255,0.7)';\r\n        ctx.font = '11px Inter, system-ui, sans-serif';\r\n        ctx.textAlign = 'center';\r\n        ctx.fillText('Galaxy forming...', W / 2, H - 58);\r\n        ctx.globalAlpha = 1;\r\n    }\r\n\r\n    // ---- UI ------------------------------------------------------------------\r\n\r\n    private buildUI(): void {\r\n        const cfg = this.cfg;\r\n        const el = document.createElement('div');\r\n        el.id = 'galaxy-ui';\r\n        el.innerHTML = `\r\n<div class=\"ui-title\">Milky Way Controls</div>\r\n<div class=\"ui-section\"><label>Stars <span id=\"vl-s\">${cfg.starCount.toLocaleString()}</span></label>\r\n  <input type=\"range\" id=\"sl-s\" min=\"2000\" max=\"20000\" step=\"1000\" value=\"${cfg.starCount}\"></div>\r\n<div class=\"ui-section\"><label>Dust <span id=\"vl-d\">${cfg.dustCount.toLocaleString()}</span></label>\r\n  <input type=\"range\" id=\"sl-d\" min=\"0\" max=\"6000\" step=\"500\" value=\"${cfg.dustCount}\"></div>\r\n<div class=\"ui-section\"><label>Galaxy Radius <span id=\"vl-r\">${cfg.galaxyRadius}</span></label>\r\n  <input type=\"range\" id=\"sl-r\" min=\"500\" max=\"6000\" step=\"100\" value=\"${cfg.galaxyRadius}\"></div>\r\n<div class=\"ui-section\"><label>Black Hole Mass <span id=\"vl-m\">${(cfg.blackHoleMass / 1e6).toFixed(1)}M</span></label>\r\n  <input type=\"range\" id=\"sl-m\" min=\"200000\" max=\"12000000\" step=\"200000\" value=\"${cfg.blackHoleMass}\"></div>\r\n<div class=\"ui-section\"><label>Sim Speed <span id=\"vl-v\">${cfg.simSpeed.toFixed(1)}x</span></label>\r\n  <input type=\"range\" id=\"sl-v\" min=\"0\" max=\"5\" step=\"0.1\" value=\"${cfg.simSpeed}\"></div>\r\n<div class=\"ui-section\"><label>Formation Time <span id=\"vl-f\">${cfg.formationDuration}s</span></label>\r\n  <input type=\"range\" id=\"sl-f\" min=\"3\" max=\"60\" step=\"1\" value=\"${cfg.formationDuration}\"></div>\r\n<button id=\"btn-respawn\">Regenerate</button>\r\n<div class=\"ui-hints\">Left drag: orbit 3D  |  Right drag: pan  |  Scroll: zoom</div>`;\r\n        const wire = (id: string, vid: string, fn: (v: number) => string) => {\r\n            const sl = el.querySelector(`#${id}`) as HTMLInputElement;\r\n            const vl = el.querySelector(`#${vid}`) as HTMLElement;\r\n            sl?.addEventListener('input', () => { if (vl) vl.textContent = fn(parseFloat(sl.value)); });\r\n        };\r\n        wire('sl-s', 'vl-s', v => { cfg.starCount = v; return v.toLocaleString(); });\r\n        wire('sl-d', 'vl-d', v => { cfg.dustCount = v; return v.toLocaleString(); });\r\n        wire('sl-r', 'vl-r', v => { cfg.galaxyRadius = v; return `${v}`; });\r\n        wire('sl-m', 'vl-m', v => { cfg.blackHoleMass = v; return `${(v / 1e6).toFixed(1)}M`; });\r\n        wire('sl-v', 'vl-v', v => { cfg.simSpeed = v; return `${v.toFixed(1)}x`; });\r\n        wire('sl-f', 'vl-f', v => { cfg.formationDuration = v; return `${v}s`; });\r\n        el.querySelector('#btn-respawn')?.addEventListener('click', () => { this.initQt(); this.spawn(); });\r\n        document.body.appendChild(el);\r\n    }\r\n}\r\n", "/**\r\n * main.ts - Entry point for the AntiGravity Engine galaxy simulation\r\n */\r\nimport { GameCore } from './engine/GameCore.js';\r\nimport { GalaxyScene } from './game/GalaxyScene.js';\r\n\r\nconst canvas = document.getElementById('game-canvas') as HTMLCanvasElement;\r\nif (!canvas) throw new Error('Canvas element not found!');\r\n\r\nconst game = new GameCore({\r\n    canvas,\r\n    fixedDt: 1 / 60,\r\n    maxDeltaTime: 0.05,\r\n});\r\n\r\nconst galaxyScene = new GalaxyScene();\r\n\r\n// Pass fps to scene HUD\r\ngame.on('update', () => {\r\n    galaxyScene.fpsRef.fps = game.fps;\r\n});\r\n\r\ngame.start(galaxyScene);\r\n"],
  "mappings": "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",
  "names": ["canvas", "canvas", "canvas"]
}
